## Особенности адаптивной верстки
Адаптивность имеет смысл, когда есть достаточный процент просмотров с разных девайсов.

Нужно делать письмо простым. Кнопки большими. Вокруг CTA-элементов стоит учесть 10-15 пикселей, чтобы проще было тыкать.

## Подходы к адаптации email
### Мобильная верстка
Тупо ширина письма 320 пикселей. Быстро делать. На мобиле норм, на десктопе по-конченному выглядит. Может быть норм, если очень большой процент прочтений с мобилников (>=70%). Например, для мобильных сервисов, курьерских служб.

Пример письма на 320: [email320.html](./email320.html).

### Резиновая верстка
Размеры в процентах, письмо занимает возможную ширину.

Часто размеры ограницивают в 600-700 пикселей.

### Медиа-запросы
Можно делать много чего.

Прописывают их в теге `<style>` внутри `<head>`. Причем нужно использовать не классы, а атрибуты:

```html
<style>
    td[class="table700"] {
        width: 700px;
    }
</style>
```

Это критично для веб-интерфейса Yahoo (нахер он нам нужен, только...).

- [ ] Проверить, на сколько критично писать стили не по классу, а по атрибуту.

Медиа-запросы поддерживаются плохо. Приложения на iOS и Андроид поддерживают, остальные не особо.

### Рекомендуемый подход
Резиновая верстка + Медиа-запросы.

В резиновой верстке закрепляем макет, чтоб не разваливался. В медиа-запросах делаем стилизацию, которая должна отличаться на разных девайсах (скрытие блоков, рамки, цвета, размеры шрифта).

## Базовый шаблон адаптивного письма
Самые большие проблемы с Аутлуком 2007, 2010, 2013.

Для фиксов отображения в Аутлуке можно юзать условные комментарии для создания дополнительной разметки:

```html
<!--[if gte mso 9]>
    <table width="400" border="1" cellspacing="0" cellpadding="0">
        <tr><td width=“50%”>
<![endif]-->
Текст1
<!--[if gte mso 9]>
        </td><td width=“50%”>
<![endif]-->
Текст2
<!--[if gte mso 9]>
        </td></tr>
    </table>
<![endif]-->
```

Чтобы избежать проблем с размерами шрифта в мейл-клиенте на iOS нужно прописать такое для одного из родительских элементов:

```html
<head>
    <style type="text/css">
        html {
            -webkit-text-size-adjust:none;
            -ms-text-size-adjust: none;
        }
    </style>
</head>
```

Тело письма:

```html
<body style="margin: 0; padding: 0;">
    <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr><td align="center" bgcolor="#ffffff">
            <!-- Доп. таблица с жесткой шириной для Аутлука, который не поддерживает max-width -->
            <!--[if (gte mso 9)|(IE)]>
                <table width="700" border="0" cellspacing="0" cellpadding="0"><tr><td>
            <![endif]-->
            <table width="100%" border="0" cellspacing="0" cellpadding="0" class="table700"
                style="max-width: 700px;min-width:320px;">
                <tr><td align=“center" >

                    Хедер
                    Тело письма
                    Футер

                </td></tr>
            </table>
            <!--[if (gte mso 9)|(IE)]> </td></tr> </table> <![endif]-->
      </td></tr>
    </table>
</body>
```

### Изображения и фон
Использовать изображения в 2 раза больше, чтобы не было размытости на ретине. Если надо иконку 100x100, то делаем 200x200 и ужимаем до 100x100 в HTML.

`background-position` не всеми поддерживается (Gmail, не поддерживает). Поэтому надо аккуратно.

Аутлук 2007—2013 не поддерживает фоновые изображения. Но это можно обойти, используя VML. Тут есть тулзы для этого: https://tools.emailmatrix.ru


## Приемы мобильной адаптации

### Блочная адаптация
Например, перестроение товарной сетки: на десктопе один товар за другим, на мобиле — один под другим.

Верстка основана на плавающих блоках. Но Аутлук ее не поддерживает и для него строится вспомогательная табличная структура.

```html
<!--[if gte mso 9]>
<table width="600" border="0" cellspacing="0" cellpadding="0"><tr><td> <![endif]-->
Блок1
<!--[if gte mso 9]></td><td><![endif]-->
Блок2
<!--[if gte mso 9]>
</td></tr></table>
<![endif]-->
```

См. `5_block-adaptation.html`.

### Фланговая адаптация
Если нужно разместить визуал с текстом поверх него, то для адаптивности можно разделить его на 2 части и вторую часть скрывать на мобиле. См. `5_flang-adaptation.html`.

## Инструменты HTML-верстальщика
### Тестирование
1. Проверить валидность.
2. Проверить отображение. Лучше всего руками. Но есть [Email on Acid](https://www.emailonacid.com) и [Litmus](https://litmus.com).

При улучшении письма для одних почтовых клиентов нужно, чтобы письма не ломались на других.

Тут есть какие-то ништяки: https://tools.emailmatrix.ru

https://www.mail-tester.com — проверка на спам.

[Интерактивные емейлы](https://litmus.com/blog/interactive-email-for-beginners-6-interactive-elements-you-can-add-to-your-emails-today), статья от Литмуса. У них письма бывают такие.
